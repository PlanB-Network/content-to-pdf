export const ORANGE = '#FF5C00';

// Inline PlanB Academy horizontal logo SVG (black variant)
const PLANB_LOGO_SVG = `<svg class="pdf-footer-logo" aria-hidden="true" viewBox="0 0 505 93" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#pf-clip)"><rect x="176.672" y="17.521" width="24.655" height="59.3026" fill="white"/><path d="M188.308 48.9942H185.387V61.4149H189.142C190.267 61.4149 191.109 61.1042 191.659 60.5079C192.209 59.9117 192.493 58.8703 192.493 57.4007V53.8735C192.493 52.0343 192.175 50.7662 191.513 50.0608C190.852 49.3553 189.778 48.9858 188.308 48.9858V48.9942Z" fill="#FF5C00"/><path d="M190.852 42.217C191.488 41.5704 191.805 40.4702 191.805 38.9418V36.6827C191.805 33.9197 190.706 32.534 188.514 32.5005H185.369V43.1996H187.939C189.236 43.1996 190.224 42.8636 190.86 42.2086L190.852 42.217Z" fill="#FF5C00"/><path d="M188.506 0C177.739 0 169 8.53242 169 19.0636V73.9364C169 84.4592 177.73 93 188.506 93C199.273 93 208.012 84.4676 208.012 73.9364V19.0636C208.012 8.54082 199.281 0 188.506 0ZM198.972 57.6022C198.972 60.7347 198.13 63.1113 196.463 64.749C195.414 65.7735 194.065 66.4706 192.416 66.8569V68.2929C192.416 69.3175 191.556 70.1573 190.508 70.1573C189.46 70.1573 188.592 69.3175 188.592 68.2929V67.2012H185.369V68.2929C185.369 69.3175 184.51 70.1573 183.462 70.1573C182.413 70.1573 181.554 69.3175 181.554 68.2929V67.2012H180.961C179.578 67.2012 178.882 66.521 178.882 65.1689V28.7465C178.882 27.3944 179.578 26.7142 180.961 26.7142H181.554V24.6987C181.554 23.6741 182.413 22.8343 183.462 22.8343C184.51 22.8343 185.369 23.6741 185.369 24.6987V26.7142H188.592V24.6987C188.592 23.6741 189.451 22.8343 190.508 22.8343C191.565 22.8343 192.416 23.6741 192.416 24.6987V26.8822C192.416 26.9661 192.398 27.0417 192.39 27.1173C193.911 27.4868 195.131 28.1083 196.033 28.9985C197.563 30.5269 198.345 32.87 198.345 36.0276V37.6401C198.345 41.7887 196.927 44.4425 194.126 45.5762V45.6854C197.365 46.7603 198.981 49.5821 198.981 54.1254V57.6022H198.972Z" fill="#FF5C00"/></g><path d="M7.37199 81.9999C5.23799 81.9999 3.97699 80.7389 3.97699 78.6049V17.4949C3.97699 15.3609 5.23799 14.0999 7.37199 14.0999H19.691C30.361 14.0999 35.599 20.0169 35.599 30.8809V37.5739C35.599 48.4379 30.361 54.3549 19.691 54.3549H14.647V78.6049C14.647 80.7389 13.386 81.9999 11.252 81.9999H7.37199ZM14.647 44.6549H19.691C23.086 44.6549 24.929 43.1029 24.929 38.2529V30.2019C24.929 25.3519 23.086 23.7999 19.691 23.7999H14.647V44.6549Z" fill="black"/><path d="M44.789 81.9999C42.655 81.9999 41.394 80.7389 41.394 78.6049V17.4949C41.394 15.3609 42.655 14.0999 44.789 14.0999H48.669C50.803 14.0999 52.064 15.3609 52.064 17.4949V72.2999H66.226C68.36 72.2999 69.621 73.5609 69.621 75.6949V78.6049C69.621 80.7389 68.36 81.9999 66.226 81.9999H44.789Z" fill="black"/><path d="M75.7956 81.9999C73.7586 81.9999 72.5946 80.9329 72.5946 79.0899C72.5946 78.8959 72.5946 78.7989 72.6916 78.2169L82.8766 17.2039C83.1676 15.1669 84.4286 14.0999 86.4656 14.0999H94.7106C96.7476 14.0999 98.0086 15.1669 98.2996 17.2039L108.485 78.2169C108.582 78.7989 108.582 78.8959 108.582 79.0899C108.582 80.9329 107.418 81.9999 105.381 81.9999H101.598C99.5606 81.9999 98.2026 81.0299 97.9116 78.8959L96.4566 68.5169V68.7109H83.9436L82.4886 78.8959C82.1976 81.0299 80.8396 81.9999 78.8026 81.9999H75.7956ZM85.2046 59.4959H95.1956L90.2486 25.9339H90.0546L85.2046 59.4959Z" fill="black"/><path d="M117.444 81.9999C115.31 81.9999 114.049 80.7389 114.049 78.6049V17.4949C114.049 15.3609 115.31 14.0999 117.444 14.0999H124.428C126.465 14.0999 127.726 14.9729 128.211 17.0099L137.814 54.7429H138.008V17.4949C138.008 15.3609 139.269 14.0999 141.403 14.0999H144.119C146.253 14.0999 147.514 15.3609 147.514 17.4949V78.6049C147.514 80.7389 146.253 81.9999 144.119 81.9999H139.56C137.523 81.9999 136.262 81.1269 135.777 79.0899L123.749 32.4329H123.555V78.6049C123.555 80.7389 122.294 81.9999 120.16 81.9999H117.444Z" fill="black"/><path d="M229.656 81.9999C227.619 81.9999 226.455 80.9329 226.455 79.0899C226.455 78.8959 226.455 78.7989 226.552 78.2169L236.737 17.2039C237.028 15.1669 238.289 14.0999 240.326 14.0999H248.571C250.608 14.0999 251.869 15.1669 252.16 17.2039L262.345 78.2169C262.442 78.7989 262.442 78.8959 262.442 79.0899C262.442 80.9329 261.278 81.9999 259.241 81.9999H255.458C253.421 81.9999 252.063 81.0299 251.772 78.8959L250.317 68.5169V68.7109H237.804L236.349 78.8959C236.058 81.0299 234.7 81.9999 232.663 81.9999H229.656ZM239.065 59.4959H249.056L244.109 25.9339H243.915L239.065 59.4959Z" fill="black"/><path d="M282.755 82.9699C272.473 82.9699 267.041 76.7619 267.041 66.2859V29.8139C267.041 19.3379 272.473 13.1299 282.755 13.1299C293.037 13.1299 298.469 19.3379 298.469 29.8139V33.5969C298.469 35.7309 297.208 36.9919 295.074 36.9919H291.776C289.642 36.9919 288.381 35.7309 288.381 33.5969V29.1349C288.381 24.6729 286.247 22.8299 283.046 22.8299C279.845 22.8299 277.711 24.6729 277.711 29.1349V67.0619C277.711 71.5239 279.845 73.2699 283.046 73.2699C286.247 73.2699 288.381 71.5239 288.381 67.0619V60.0779C288.381 57.9439 289.642 56.6829 291.776 56.6829H295.074C297.208 56.6829 298.469 57.9439 298.469 60.0779V66.2859C298.469 76.7619 293.037 82.9699 282.755 82.9699Z" fill="black"/><path d="M305.532 81.9999C303.495 81.9999 302.331 80.9329 302.331 79.0899C302.331 78.8959 302.331 78.7989 302.428 78.2169L312.613 17.2039C312.904 15.1669 314.165 14.0999 316.202 14.0999H324.447C326.484 14.0999 327.745 15.1669 328.036 17.2039L338.221 78.2169C338.318 78.7989 338.318 78.8959 338.318 79.0899C338.318 80.9329 337.154 81.9999 335.117 81.9999H331.334C329.297 81.9999 327.939 81.0299 327.648 78.8959L326.193 68.5169V68.7109H313.68L312.225 78.8959C311.934 81.0299 310.576 81.9999 308.539 81.9999H305.532ZM314.941 59.4959H324.932L319.985 25.9339H319.791L314.941 59.4959Z" fill="black"/><path d="M347.181 81.9999C345.047 81.9999 343.786 80.7389 343.786 78.6049V17.4949C343.786 15.3609 345.047 14.0999 347.181 14.0999H360.082C370.752 14.0999 375.99 20.0169 375.99 30.8809V65.2189C375.99 76.0829 370.752 81.9999 360.082 81.9999H347.181ZM354.456 72.2999H359.888C363.283 72.2999 365.32 70.5539 365.32 65.7039V30.3959C365.32 25.5459 363.283 23.7999 359.888 23.7999H354.456V72.2999Z" fill="black"/><path d="M386.587 81.9999C384.453 81.9999 383.192 80.7389 383.192 78.6049V17.4949C383.192 15.3609 384.453 14.0999 386.587 14.0999H408.897C411.031 14.0999 412.292 15.3609 412.292 17.4949V20.4049C412.292 22.5389 411.031 23.7999 408.897 23.7999H393.862V41.7449H405.114C407.248 41.7449 408.509 43.0059 408.509 45.1399V48.0499C408.509 50.1839 407.248 51.4449 405.114 51.4449H393.862V72.2999H408.897C411.031 72.2999 412.292 73.5609 412.292 75.6949V78.6049C412.292 80.7389 411.031 81.9999 408.897 81.9999H386.587Z" fill="black"/><path d="M421.825 81.9999C419.691 81.9999 418.43 80.7389 418.43 78.6049V17.4949C418.43 15.3609 419.691 14.0999 421.825 14.0999H430.458C432.495 14.0999 433.853 15.0699 434.144 17.2039L440.449 62.6969H440.643L446.948 17.2039C447.239 15.0699 448.597 14.0999 450.634 14.0999H459.267C461.401 14.0999 462.662 15.3609 462.662 17.4949V78.6049C462.662 80.7389 461.401 81.9999 459.267 81.9999H455.969C453.835 81.9999 452.574 80.7389 452.574 78.6049V30.5899H452.38L445.105 78.8959C444.814 81.0299 443.456 81.9999 441.419 81.9999H438.897C436.86 81.9999 435.502 81.0299 435.211 78.8959L427.936 30.5899H427.742V78.6049C427.742 80.7389 426.481 81.9999 424.347 81.9999H421.825Z" fill="black"/><path d="M483.816 81.9999C481.682 81.9999 480.421 80.7389 480.421 78.6049V53.0939L468.587 17.9799C468.393 17.3979 468.393 17.0099 468.393 16.6219C468.393 14.9729 469.46 14.0999 471.4 14.0999H475.668C477.705 14.0999 478.966 14.8759 479.548 16.9129L486.144 39.0289H486.338L492.934 16.9129C493.516 14.8759 494.777 14.0999 496.814 14.0999H500.112C502.052 14.0999 503.119 14.9729 503.119 16.6219C503.119 17.0099 503.119 17.3979 502.925 17.9799L491.091 53.0939V78.6049C491.091 80.7389 489.83 81.9999 487.696 81.9999H483.816Z" fill="black"/><defs><clipPath id="pf-clip"><rect width="39" height="93" fill="white" transform="translate(169)"/></clipPath></defs></svg>`;

export function getSharedCss(): string {
  return `
    @page {
      size: A4;
      margin: 15mm 20mm 25mm 20mm;
    }
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.3;
      color: #1a1a1a;
      margin: 0;
      padding: 0;
      background: white;
      font-size: 11pt;
      orphans: 3;
      widows: 3;
    }

    /* ============ Cover page ============ */
    .cover-page {
      page-break-after: always;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      padding: 40px 20px 30px 20px;
    }
    .cover-top { }
    .cover-title {
      font-size: 32pt;
      font-weight: 800;
      color: #1a1a1a;
      margin: 0 0 8px 0;
      line-height: 1.15;
    }
    .cover-code {
      font-size: 16pt;
      color: #666;
      margin: 0 0 6px 0;
      letter-spacing: 1px;
    }
    .cover-subtitle {
      font-size: 18pt;
      color: ${ORANGE};
      font-weight: 600;
      margin: 0 0 6px 0;
    }
    .cover-meta {
      font-size: 11pt;
      color: #888;
      margin: 0 0 24px 0;
    }
    .cover-goal {
      border-left: 4px solid ${ORANGE};
      padding: 12px 16px;
      background: #fef7f2;
      margin: 16px 0;
      font-size: 11pt;
      color: #333;
    }
    .cover-goal-label {
      font-weight: 700;
      color: ${ORANGE};
      text-transform: uppercase;
      font-size: 9pt;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }
    .cover-objectives {
      margin: 20px 0;
    }
    .cover-objectives-label {
      font-size: 12pt;
      font-weight: 700;
      color: ${ORANGE};
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
      padding-bottom: 6px;
      border-bottom: 2px solid ${ORANGE};
    }
    .cover-objectives-title {
      font-weight: 600;
      margin: 8px 0;
      font-size: 10pt;
    }

    /* ============ Instructor section ============ */
    .instructor-section {
      margin-bottom: 28px;
    }
    .instructor-logo-wrap {
      text-align: center;
      margin-bottom: 12px;
    }
    .instructor-logo {
      max-height: 60px;
      max-width: 180px;
      object-fit: contain;
      display: inline-block;
    }
    .instructor-divider {
      border: none;
      border-top: 1.5px dashed #999;
      margin: 12px 0;
    }
    .instructor-name-line {
      font-size: 11pt;
      font-weight: 600;
      color: #1a1a1a;
    }
    .instructor-source {
      font-size: 9pt;
      color: #888;
      margin-top: 4px;
    }

    /* ============ Table of Contents ============ */
    .toc-page { page-break-after: always; }
    .toc-heading {
      font-size: 14pt;
      font-weight: 700;
      color: ${ORANGE};
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 20px;
      padding-bottom: 8px;
      border-bottom: 2px solid ${ORANGE};
    }
    .toc-part {
      font-size: 11pt;
      font-weight: 700;
      text-transform: uppercase;
      color: #333;
      margin: 16px 0 6px 0;
      padding: 4px 0;
    }
    .toc-chapter {
      font-size: 10pt;
      color: #555;
      margin: 4px 0 4px 20px;
    }
    .toc-chapter a {
      color: #555;
      text-decoration: none;
    }
    .toc-chapter a:hover { color: ${ORANGE}; }

    /* ============ Part headers ============ */
    .part-header {
      margin-top: 60px;
      margin-bottom: 10px;
      page-break-after: avoid;
    }
    .part-label {
      font-size: 9pt;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: ${ORANGE};
      font-weight: 700;
      margin-bottom: 4px;
    }
    .part-title {
      font-size: 22pt;
      font-weight: 800;
      color: #1a1a1a;
      text-transform: uppercase;
      padding-bottom: 10px;
      border-bottom: 3px solid ${ORANGE};
      margin: 0;
    }

    /* ============ Chapter headers ============ */
    .chapter-header {
      page-break-before: always;
      margin-top: 40px;
      margin-bottom: 20px;
      page-break-after: avoid;
    }
    .part-header + .chapter-header {
      page-break-before: avoid;
      margin-top: 24px;
    }
    .chapter-part-name {
      font-size: 9pt;
      color: #999;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 2px;
    }
    .chapter-number {
      font-size: 10pt;
      color: ${ORANGE};
      font-weight: 600;
      margin-bottom: 6px;
    }
    .chapter-title {
      font-size: 24pt;
      font-weight: 800;
      color: #1a1a1a;
      margin: 0;
      line-height: 1.2;
    }

    /* ============ Content ============ */
    h1, h2, h3, h4, h5, h6 {
      page-break-after: avoid;
      break-after: avoid;
      page-break-inside: avoid;
    }
    h3 {
      font-size: 13pt;
      font-weight: 700;
      color: #2c3e50;
      margin-top: 22px;
      margin-bottom: 8px;
    }
    h4 {
      font-size: 11pt;
      font-weight: 700;
      color: #34495e;
      margin-top: 16px;
      margin-bottom: 6px;
    }
    p {
      margin: 8px 0;
      text-align: justify;
    }
    a { color: ${ORANGE}; text-decoration: none; }
    strong { font-weight: 700; }

    img {
      max-width: 80%;
      max-height: 450px;
      height: auto;
      display: block;
      margin: 14px auto;
      page-break-inside: avoid;
      break-inside: avoid;
    }
    p:has(> img) {
      break-inside: avoid;
      page-break-inside: avoid;
    }
    .img-wrap {
      break-inside: avoid;
      page-break-inside: avoid;
      text-align: center;
    }
    blockquote {
      border-left: 4px solid ${ORANGE};
      padding: 10px 16px;
      margin: 14px 0;
      background: #fef7f2;
      color: #444;
      font-style: italic;
      page-break-inside: avoid;
      break-inside: avoid;
    }
    blockquote p { margin: 4px 0; }
    code {
      background: #f4f4f4;
      padding: 1px 5px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 9.5pt;
    }
    pre {
      background: #f4f4f4;
      padding: 12px 16px;
      border-radius: 5px;
      overflow-x: auto;
      page-break-inside: avoid;
      break-inside: avoid;
      font-size: 9pt;
      line-height: 1.5;
    }
    pre code { background: none; padding: 0; }
    ul, ol {
      margin: 10px 0;
      padding-left: 24px;
    }
    li {
      margin: 3px 0;
      page-break-inside: avoid;
      break-inside: avoid;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin: 14px 0;
      page-break-inside: avoid;
      break-inside: avoid;
      font-size: 9.5pt;
    }
    thead { background: #f2f2f2; }
    th, td {
      border: 1px solid #ddd;
      padding: 8px 10px;
      text-align: left;
      vertical-align: top;
    }
    th { font-weight: 700; background: #f2f2f2; }
    tr:nth-child(even) { background: #fafafa; }

    /* ============ Quiz styling ============ */
    .quiz-header-box {
      background: ${ORANGE};
      color: white;
      padding: 12px 20px;
      border-radius: 6px;
      margin-bottom: 24px;
      font-size: 14pt;
      font-weight: 700;
    }
    .question-block {
      margin-bottom: 28px;
      page-break-inside: avoid;
    }
    .question-number {
      font-weight: 700;
      color: ${ORANGE};
      font-size: 10pt;
      margin-bottom: 4px;
    }
    .question-text {
      font-weight: 600;
      font-size: 11pt;
      margin-bottom: 10px;
      color: #1a1a1a;
    }
    .choice {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin: 6px 0;
      padding: 6px 10px;
      border-radius: 4px;
    }
    .choice-letter {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 22px;
      height: 22px;
      min-width: 22px;
      border-radius: 50%;
      background: #f0f0f0;
      font-weight: 700;
      font-size: 9pt;
      color: #555;
    }
    .choice-text { font-size: 10pt; color: #333; padding-top: 2px; }

    /* ============ Answer key ============ */
    .answer-key { page-break-before: always; }
    .answer-key-title {
      font-size: 16pt;
      font-weight: 700;
      color: ${ORANGE};
      margin-bottom: 20px;
      padding-bottom: 8px;
      border-bottom: 2px solid ${ORANGE};
    }
    .answer-item {
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #eee;
      page-break-inside: avoid;
    }
    .answer-item-header {
      font-weight: 700;
      color: #333;
      font-size: 10pt;
    }
    .answer-correct {
      color: ${ORANGE};
      font-weight: 700;
    }
    .answer-explanation {
      font-size: 9.5pt;
      color: #666;
      margin-top: 4px;
    }

    /* ============ Final page ============ */
    .final-page {
      page-break-before: always;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 60px 20px 30px 20px;
    }
    .final-page-content {
      text-align: center;
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .final-page-content h2 {
      color: #1a1a1a;
      font-size: 18pt;
      font-weight: 700;
      margin-bottom: 30px;
      max-width: 400px;
    }
    .final-page-content img {
      max-width: 200px;
      margin: 0 auto 20px auto;
    }
    .final-url {
      color: #666;
      font-size: 9pt;
      word-break: break-all;
    }

    /* ============ Objectives ============ */
    .objectives-list {
      list-style: none;
      padding: 0;
    }
    .objectives-list li {
      padding: 4px 0 4px 24px;
      position: relative;
      font-size: 10pt;
    }
    .objectives-list li::before {
      content: "\\2713";
      position: absolute;
      left: 0;
      color: ${ORANGE};
      font-weight: 700;
    }

    /* ============ Page footer ============ */
    .pdf-footer {
      display: none;
    }
    .pdf-footer-left {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .pdf-footer-logo {
      height: 10px;
      width: auto;
      opacity: 0.5;
    }
    .pdf-footer-corporate {
      height: 14px;
      width: auto;
      max-width: 80px;
      object-fit: contain;
      opacity: 0.6;
    }
    .pdf-footer-x {
      font-size: 7pt;
      color: #bbb;
    }
    .pdf-footer-page {
      font-size: 7.5pt;
      color: #999;
    }

    /* ============ Print (paginated output) ============ */
    @media print {
      body {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      /* Fixed footer for non-paginated print (openPrintWindow).
         In paginated mode, the script removes .pdf-footer from the DOM
         so this rule is inert; the .pdf-footer-clone rules below apply instead. */
      .pdf-footer {
        display: flex !important;
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        align-items: center;
        justify-content: space-between;
        padding-top: 1.5mm;
        border-top: 1pt solid #999;
      }
      .pdf-footer-page::after {
        content: counter(page);
      }
      /* Each wrapper = one printed page */
      .pdf-page-wrapper { page-break-after: always; break-after: page; }
      .pdf-page-wrapper:last-child { page-break-after: auto; break-after: auto; }
      .pdf-page-wrapper::after { display: none; }
      .pdf-page { position: relative; overflow: hidden; }
      /* Disable per-element breaks inside paginated pages */
      .pdf-page .cover-page { page-break-after: auto; min-height: auto; }
      .pdf-page .toc-page { page-break-after: auto; }
      .pdf-page .chapter-header { page-break-before: auto; }
      .pdf-page .part-header + .chapter-header { page-break-before: auto; }
      .pdf-page .final-page { page-break-before: auto; min-height: auto; }
      .pdf-page .answer-key { page-break-before: auto; }
      /* Footer clones */
      .pdf-footer-clone {
        display: flex !important;
        position: absolute;
        bottom: 8mm;
        left: 20mm;
        right: 20mm;
        align-items: center;
        justify-content: space-between;
        padding-top: 1.5mm;
        border-top: 1pt solid #999;
        font-size: 7pt;
        color: #999;
      }
      .pdf-footer-clone .pdf-footer-logo { height: 8px; }
      .pdf-footer-clone .pdf-footer-corporate { height: 10px; }
    }
  `;
}

export function generateFooterHtml(presenterLogo?: string): string {
  const corporatePart = presenterLogo
    ? `<span class="pdf-footer-x">\u00D7</span><img class="pdf-footer-corporate" src="${presenterLogo}" alt="" />`
    : '';

  return `
    <div class="pdf-footer">
      <div class="pdf-footer-left">
        ${PLANB_LOGO_SVG}
        ${corporatePart}
      </div>
      <div class="pdf-footer-page"></div>
    </div>
  `;
}
